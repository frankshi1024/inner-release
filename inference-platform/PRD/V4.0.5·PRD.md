# 算法推理平台V4.0.5需求说明文档



## 修改记录

| 版本号 | 修改日期 | 修改人 | 概述     | 详细说明 | 原型定位 |
| ------ | -------- | ------ | -------- | -------- | -------- |
| V0.8   | 20190827 | 时建军 | 方案设计 | ——       | ——       |
|        |          |        |          |          |          |
|        |          |        |          |          |          |



## 一、需求背景

V4.0.5，是基于V4.0进行功能完善的版本，主要目的为强化部分功能，优化体验。

[点击查看原型](https://release1024.oss-ap-southeast-1.aliyuncs.com/prototype/%E6%8E%A8%E7%90%86%E5%B9%B3%E5%8F%B0/%E7%AE%97%E6%B3%95%E6%8E%A8%E7%90%86%E5%B9%B3%E5%8F%B0%C2%B74.0.5/index.html)



## 二、项目信息

| 里程碑       | 计划日期 | 负责人 | 备注 |
| ------------ | -------- | ------ | ---- |
| 产品方案制定 | 20190827 | 时建军 |      |
| 技术与提测   |          | 冯立灿 |      |
| 测试完成     |          | 郑重   |      |
| 交付部署     |          | 时建军 |      |



## 三、功能说明

### 1. 网络插件优化：改用calico

目的：

开发：由开发负责技术方案的制定和实现。

负责人：立灿

执行人：杨晓声

注意事项：需要输出技术说明文档



### 2. K8S服务信息由代码获取

#### 目的

减少部署时工作人员工作量，优化体验，减少出错几率。

#### 方案说明

- 部署完成后，后端即自动通过脚本获取；
- 在用户打开推理平台客户端界面时，默认已设置，K8S服务信息可修改（页面保持不变，修改底层功能）。

#### 原型说明

![](https://release1024.oss-ap-southeast-1.aliyuncs.com/prototype/推理平台/算法推理平台·4.0.5/images/控制台·环境参数·监控服务.png)

### 3. 视频断线重连

#### 业务流程

如下图所示：

- 前端在播放某一路视频流时，会触发轮询任务，不断查询网络状态及直播流状态；
- 通过get请求查询后台的直播流状态，后台服务则直接查询rtmp的直播流服务；
- 具体实现流程如下所示，研发实现过程中可根据实际情况修改方案，但需要同步给产品经理。

![image-20190827144204621](http://mark-pic.oss-ap-southeast-1.aliyuncs.com/2019-08-27-064206.png)



### 4. 中英文切换

#### 目的

实现推理平台国际化推广的目的。

#### 方案说明

- 前端

前端通过框架实现页面固定显示的内容，通过中英文切换可以直接切换到对应语言。

局限性：前端只能切换页面固定内容，由后台传输的数据仍需要后台提供英文版本信息。

- 后台

后台整理中英文对照信息，并在对应显示模式下传输不同的语言内容。

#### 原型说明

如下所示，默认为中文，切换开关可切换至英文（按钮显示为eng）；

切换为英文后，按钮文字显示为“中文”。

![](http://mark-pic.oss-ap-southeast-1.aliyuncs.com/2019-08-27-071230.jpg)



### 5. 修改服务配置

#### 目的

修改算法配置/algoConfig信息，使得算法调试更加灵活，更符合现场部署需求，同时减少部署人员工作量。

#### 方案说明

- 限制：需要SDK2.0及以上+vas4.0及以上/ias4.55及以上版本；
- 通过ice服务的配置修改功能实现
- ICE服务：增加读取配置参数功能@赖工

#### 原型说明

控制台/环境参数/算法服务地址：新增“算法配置”操作，点击打开弹窗

![image-20190827145618691](https://release1024.oss-ap-southeast-1.aliyuncs.com/prototype/推理平台/算法推理平台·4.0.5/images/控制台·环境参数·算法服务地址.png)

点击“保存并重启算法”，进行校验，通过后调用ICE服务修改algoConfig接口：

配置项允许为空，使用默认值。

![image-20190827145639038](https://release1024.oss-ap-southeast-1.aliyuncs.com/prototype/推理平台/算法推理平台·4.0.5/images/控制台·环境参数·算法服务地址·修改服务配置.png)

#### 附：vas服务接口

![image-20190827150449953](http://mark-pic.oss-ap-southeast-1.aliyuncs.com/2019-08-27-070451.png)